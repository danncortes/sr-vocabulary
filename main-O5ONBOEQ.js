import{a as v,b,c as s,f as k,g as w,h as y,i as p}from"./chunk-5W4MO4JS.js";import{$ as e,C as f,Nb as C,Q as l,Wa as h,lc as A,mb as d,mc as g,nc as R,o as a}from"./chunk-3UVZE6IW.js";var H=()=>{let t=e(p),o=e(s);return t.isAuthenticated()?!0:o.parseUrl("/login")};var S=()=>{let t=e(p),o=e(s);return t.isAuthenticated()?o.parseUrl("/dashboard"):!0};var F=[{path:"login",loadComponent:()=>import("./chunk-XHQZS4Y2.js").then(t=>t.LoginComponent),canActivate:[S]},{path:"",loadComponent:()=>import("./chunk-ALGHAMMN.js").then(t=>t.MainLayoutComponent),canActivate:[H],children:[{path:"dashboard",loadComponent:()=>import("./chunk-2T2HKZTV.js").then(t=>t.DashboardComponent)},{path:"vocabulary",loadComponent:()=>import("./chunk-7G5KUPFZ.js").then(t=>t.VocabularyViewComponent)},{path:"",redirectTo:"dashboard",pathMatch:"full"}]},{path:"**",redirectTo:"dashboard"}];var x=["expired","Invalid or missing token"],c=!1,M=(t,o)=>t.clone({headers:t.headers.set("Authorization",`Bearer ${o}`)}),E=(t,o)=>{let r=e(p),u=r.getToken();return t.url.includes("/user/refresh")?o(t):u?o(M(t,u)).pipe(f(i=>{if(i.status===401){let T=i.error?.error||"";if(x.some(n=>T.includes(n))&&!c)return c=!0,r.refreshToken().pipe(l(n=>(c=!1,n?.access_token?o(M(t,n.access_token)):a(()=>i))),f(n=>(c=!1,r.logout(),a(()=>n))))}return a(()=>i)})):o(t)};var I={providers:[C({eventCoalescing:!0}),w(F,y(k)),A(R(),g([E]))]};var m=class t{title="sr-vocabulary";static \u0275fac=function(r){return new(r||t)};static \u0275cmp=h({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(r,u){r&1&&d(0,"router-outlet")},dependencies:[b],encapsulation:2})};v(m,I).catch(t=>console.error(t));
