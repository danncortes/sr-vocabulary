import{$ as d,Ma as W,Rb as D,S as f,Sb as U,V as g,Wa as G,_a as Z,a as i,b,c as B,d as R,g as x,gb as K,hb as z,jc as w,kb as q,kc as S,la as v,lb as J,mb as T,n as H,oc as V,pa as F,va as M,xa as N,y as L,ya as C}from"./chunk-3UVZE6IW.js";function Q(t){let e=D(()=>t());return se(e)?new Proxy(t,{get(r,o){return o in e?(N(r[o])||Object.defineProperty(r,o,{value:U(()=>r()[o]),configurable:!0}),Q(r[o])):r[o]}}):t}var oe=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function se(t){if(t===null||typeof t!="object"||ie(t))return!1;let e=Object.getPrototypeOf(t);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(oe.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function ie(t){return typeof t?.[Symbol.iterator]=="function"}var ce=new WeakMap,y=Symbol("STATE_SOURCE");function m(t,...e){t[y].update(r=>e.reduce((o,s)=>i(i({},o),typeof s=="function"?s(o):s),r)),pe(t)}function le(t){return t[y]()}function ue(t){return ce.get(t[y])||[]}function pe(t){let e=ue(t);for(let r of e){let o=D(()=>le(t));r(o)}}function X(...t){let e=[...t],r=typeof e[0]=="function"?{}:e.shift(),o=e;return(()=>{class n{constructor(){let l=o.reduce((I,ae)=>ae(I),de()),{stateSignals:c,props:u,methods:p,hooks:h}=l,O=i(i(i({},c),u),p);this[y]=l[y];for(let I of Reflect.ownKeys(O))this[I]=O[I];let{onInit:A,onDestroy:E}=h;A&&A(),E&&d(F).onDestroy(E)}static \u0275fac=function(c){return new(c||n)};static \u0275prov=g({token:n,factory:n.\u0275fac,providedIn:r.providedIn||null})}return n})()}function de(){return{[y]:C({}),stateSignals:{},props:{},methods:{},hooks:{}}}function me(t){return e=>{let r=t(i(i(i({[y]:e[y]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(r),b(i({},e),{props:i(i({},e.props),r)})}}function Y(t){return me(t)}function ee(t){return e=>{let r=t(i(i(i({[y]:e[y]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(r),b(i({},e),{methods:i(i({},e.methods),r)})}}function te(t){return e=>{let r=typeof t=="function"?t():t,o=Reflect.ownKeys(r);e[y].update(n=>i(i({},n),r));let s=o.reduce((n,a)=>{let l=U(()=>e[y]()[a]);return b(i({},n),{[a]:Q(l)})},{});return b(i({},e),{stateSignals:i(i({},e.stateSignals),s)})}}var P=class t{http=d(S);apiBaseUrl=`${V.apiBaseUrl}/vocabulary`;baseUrl=`${V.apiBaseUrl}`;getAllVocabulary(){return this.http.get(`${this.apiBaseUrl}`)}reviewVocabulary(e){return this.http.post(`${this.apiBaseUrl}/review`,{id:e})}delayVocabulary(e,r){return this.http.post(`${this.apiBaseUrl}/delay`,{ids:e,days:r})}resetVocabulary(e){return this.http.post(`${this.apiBaseUrl}/reset`,{ids:e})}restartVocabulary(e){return this.http.post(`${this.apiBaseUrl}/restart`,{ids:e})}deleteVocabulary(e){return this.http.post(`${this.apiBaseUrl}/delete`,{ids:e})}markAsLearned(e){return this.http.patch(`${this.apiBaseUrl}/${e}/learned`,{learned:!0})}saveVocabulary(e){return this.http.post(`${this.apiBaseUrl}/create`,{vocabulary:e})}updateVocabulary(e){return this.http.post(`${this.apiBaseUrl}/update`,{vocabulary:e})}translatePhrase(e,r,o){return this.http.post(`${this.baseUrl}/translate`,{phrase:e,sourceLanguage:r,targetLanguage:o})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};var k=class t{http=d(S);baseUrl=`${V.apiBaseUrl}`;getLanguageTranslations(){return this.http.get(`${this.baseUrl}/languages/translations`)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};var _=class t{http=d(S);baseUrl=`${V.apiBaseUrl}`;currentUser=null;getCurrentUser(){return this.currentUser}updateUserProfile(e){return new x(r=>{setTimeout(()=>{this.currentUser=i(i({},this.currentUser),e),r.next(this.currentUser),r.complete()},1e3)})}getUserSettings(){return this.http.get(`${this.baseUrl}/user/settings`)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};var $=class t{constructor(){}notifications=C({});toast(e){let{permanent:r}=e,o=i({type:"info",duration:5e3,permanent:!1},e),s=Date.now();this.notifications.update(n=>b(i({},n),{[s]:o})),r||setTimeout(()=>{this.dismiss(s)},o.duration)}dismiss(e){this.notifications.update(r=>{let n=r,{[e]:o}=n;return R(n,[B(e)])})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};var fe={sourceVocabulary:[],loading:!1,error:null,languageTranslations:[],userSettings:null,isVocabularyFormOpen:!1,vocabularyToEdit:null},at=X({providedIn:"root"},te(fe),Y(({sourceVocabulary:t})=>({vocabulary:U(()=>{let e=[],r=[],o=[],s=[],n=[],a=[],l=new Date;for(let c of t()){let u=new Date(c.review_date);c.sr_stage_id===0?(c.original.audio_url||c.translated.audio_url)&&e.push(c):u<=l&&c.learned!==1?r.push(c):u>l&&c.learned===0?o.push(c):c.learned===1&&a.push(c);let p=new Date(c.modified_at).toISOString().split("T")[0]===new Date().toISOString().split("T")[0];c.sr_stage_id===1&&p?s.push(c):c.sr_stage_id>1&&p&&n.push(c)}return e.sort((c,u)=>c.priority-u.priority),o.sort((c,u)=>{let p=new Date(c.review_date),h=new Date(u.review_date);return p.getTime()-h.getTime()}),{new:e,review:r,rest:o,startedToday:s,reviewedToday:n,learned:a}})})),ee((t,e=d(P),r=d(k),o=d(_),s=d($))=>({initializeAppData(){L({languageTranslations:r.getLanguageTranslations(),userSettings:o.getUserSettings()}).pipe(f({next:n=>{m(t,{languageTranslations:n.languageTranslations,userSettings:n.userSettings,error:null})},error:n=>{s.toast({message:`Error loading app data: ${n instanceof w?n.message:String(n)}`,type:"error"})}})).subscribe(),this.getAllVocabulary()},getAllVocabulary(){m(t,{loading:!0}),e.getAllVocabulary().pipe(f({next:n=>{m(t,{sourceVocabulary:n,loading:!1,error:null})},error:n=>{m(t,{loading:!1,error:n.message})}})).subscribe()},setReviewedVocabulary(n){return e.reviewVocabulary(n).pipe(f({next:a=>{let{sr_stage_id:l,review_date:c,modified_at:u,learned:p}=a;m(t,{sourceVocabulary:t.sourceVocabulary().map(h=>h.id===n?b(i({},h),{sr_stage_id:l,review_date:c,modified_at:u,learned:p}):h)}),s.toast({message:`Vocabulary ${n} marked as reviewed`,type:"success"})},error:a=>{s.toast({message:`Error reviewing vocabulary ${n}: ${a instanceof w?a.message:String(a)}`,type:"error"})}}))},delayVocabulary(n,a){return e.delayVocabulary(n,a).pipe(f({next:l=>{m(t,{sourceVocabulary:t.sourceVocabulary().map(c=>{let p=l.find(h=>h.id===c.id);return p?b(i({},c),{review_date:p.review_date,modified_at:p.modified_at}):c})})},error:l=>{s.toast({message:`Error delaying vocabulary ${n.join(", ")} by ${a} day(s): ${l instanceof w?l.message:String(l)}`,type:"error"})}}))},resetVocabulary(n){return e.resetVocabulary(n).pipe(f({next:a=>{m(t,{sourceVocabulary:t.sourceVocabulary().map(l=>{let u=a.find(p=>p.id===l.id);return u?i(i({},l),u):l})})},error:a=>{s.toast({message:`Error resetting vocabulary ${n.join(", ")}: ${a instanceof w?a.message:String(a)}`,type:"error"})}}))},restartVocabulary(n){return e.restartVocabulary(n).pipe(f({next:a=>{m(t,{sourceVocabulary:t.sourceVocabulary().map(l=>{let u=a.find(p=>p.id===l.id);return u?i(i({},l),u):l})})},error:a=>{s.toast({message:`Error restarting vocabulary ${n.join(", ")}: ${a instanceof w?a.message:String(a)}`,type:"error"})}}))},deleteVocabulary(n){return e.deleteVocabulary(n).pipe(f({next:()=>{m(t,{sourceVocabulary:t.sourceVocabulary().filter(a=>!n.includes(a.id))}),s.toast({message:`Deleted ${n.length} vocab item(s)`,type:"success"})},error:a=>{s.toast({message:`Error deleting vocabulary ${n.join(", ")}: ${a instanceof w?a.message:String(a)}`,type:"error"})}}))},openVocabularyForm(){m(t,{isVocabularyFormOpen:!0})},closeVocabularyForm(){m(t,{isVocabularyFormOpen:!1,vocabularyToEdit:null})},editVocabulary(n){m(t,{vocabularyToEdit:t.sourceVocabulary().find(a=>a.id===n),isVocabularyFormOpen:!0})},createVocabulary(n){return e.saveVocabulary(n).pipe(f({next:a=>{let l=a;m(t,{sourceVocabulary:[...t.sourceVocabulary(),l]}),s.toast({message:"Vocabulary created successfully",type:"success"})},error:a=>{s.toast({message:`Error creating vocabulary: ${a instanceof w?a.message:String(a)}`,type:"error"})}}))},updateVocabulary(n){return e.updateVocabulary(n).pipe(f({next:a=>{let l=a;m(t,{sourceVocabulary:t.sourceVocabulary().map(c=>c.id===l.id?l:c)}),s.toast({message:"Vocabulary updated successfully",type:"success"})},error:a=>{s.toast({message:`Error updating vocabulary: ${a instanceof w?a.message:String(a)}`,type:"error"})}}))}})));var re=class t{http=d(S);baseUrl=`${V.apiBaseUrl}/audio`;audioCache=new Map;CACHE_DURATION_MS=55e3;audioPlayer=null;generateAudio(e){return this.http.post(`${this.baseUrl}/generate`,{text:e})}getAudioUrl(e){let r=this.audioCache.get(e),o=Date.now();return r&&o-r.timestamp<this.CACHE_DURATION_MS?H(r.url):this.http.get(`${this.baseUrl}/${e}`,{responseType:"text"}).pipe(f(s=>{this.audioCache.set(e,{url:s,timestamp:o})}))}playAudio(e){return new x(r=>{this.getAudioUrl(e).subscribe({next:o=>{this.audioPlayer&&(this.audioPlayer.pause(),this.audioPlayer=null),this.audioPlayer=new Audio(o),this.audioPlayer.play().then(()=>{r.next(),r.complete()}).catch(s=>{console.error("Error playing audio:",s),r.error(s)})},error:o=>{console.error("Error fetching audio:",o),r.error(o)}})})}stopAudio(){this.audioPlayer&&(this.audioPlayer.pause(),this.audioPlayer=null)}deleteAudios(e){return this.http.post(`${this.baseUrl}/delete`,{filenames:e})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"})};function ge(t,e){t&1&&(v(),T(0,"path",1))}function ye(t,e){t&1&&(v(),T(0,"path",2))}function he(t,e){t&1&&(v(),T(0,"path",3))}function be(t,e){t&1&&(v(),T(0,"path",4))}function ve(t,e){t&1&&(v(),T(0,"path",5))}function we(t,e){t&1&&(v(),T(0,"path",6))}function Ve(t,e){t&1&&(v(),T(0,"path",7))}var ne=class t{type=M.required();customClass=M("");static \u0275fac=function(r){return new(r||t)};static \u0275cmp=G({type:t,selectors:[["app-icon"]],inputs:{type:[1,"type"],customClass:[1,"customClass"]},decls:8,vars:3,consts:[["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","d","M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z"],["stroke-linecap","round","stroke-linejoin","round","d","M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"],["stroke-linecap","round","stroke-linejoin","round","d","M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"],["stroke-linecap","round","stroke-linejoin","round","d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"],["stroke-linecap","round","stroke-linejoin","round","d","M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"],["stroke-linecap","round","stroke-linejoin","round","d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"],["stroke-linecap","round","stroke-linejoin","round","d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"]],template:function(r,o){if(r&1&&(v(),q(0,"svg",0),Z(1,ge,1,0,":svg:path",1)(2,ye,1,0,":svg:path",2)(3,he,1,0,":svg:path",3)(4,be,1,0,":svg:path",4)(5,ve,1,0,":svg:path",5)(6,we,1,0,":svg:path",6)(7,Ve,1,0,":svg:path",7),J()),r&2){let s;K("size-6 "+o.customClass()),W(),z((s=o.type())==="play"?1:s==="check-circle"?2:s==="ellipsis-horizontal"?3:s==="trash"?4:s==="speaker-wave"?5:s==="speaker-x-mark"?6:s==="pencil"?7:-1)}},encapsulation:2})};export{P as a,$ as b,at as c,re as d,ne as e};
